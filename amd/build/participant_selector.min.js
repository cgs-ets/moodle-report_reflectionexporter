/**
 * Custom auto-complete adapter to load users from the assignment list_participants webservice.
 *
 * @module     report_reflectionexporter/participants_selector
 * @copyright  2015 Damyon Wiese <damyon@moodle.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("report_reflectionexporter/participant_selector",["core/ajax","jquery","core/templates"],(function(ajax,$,templates){return{processResults:function(selector,data){return data},transport:function(selector,query,success,failure){var reflecid=this._region.find("[data-action=change-user]").attr("data-rid");reflecid=this._region.find("[data-action=change-user]").attr("data-rid");ajax.call([{methodname:"report_reflectionexporter_list_participants",args:{rid:reflecid}}])[0].then((function(results){var promises=[],identityfields=$("[data-showuseridentity]").data("showuseridentity").split(",");return $.each(results,(function(index,user){var ctx=user,identity=[];$.each(identityfields,(function(i,k){void 0!==user[k]&&""!==user[k]&&(ctx.hasidentity=!0,identity.push(user[k]))})),ctx.identity=identity.join(", "),promises.push(templates.render("report_reflectionexporter/list_participant_user_summary",ctx).then((function(html){return{value:user.id,label:html}})))})),$.when.apply($,promises)})).then((function(){var users=[];arguments[0]&&(users=Array.prototype.slice.call(arguments)),success(users)})).catch(failure)}}}));

//# sourceMappingURL=participant_selector.min.js.map