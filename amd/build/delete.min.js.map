{"version":3,"sources":["../src/delete.js"],"names":["define","Ajax","Delete","document","querySelector","_addEventListeners","prototype","self","table","rows","row","l","cells","length","cl","children","aElement","console","log","setAttribute","rowIndex","addEventListener","_deleteService","bind","e","srcElement","parentElement","classList","add","nextElementSibling","remove","call","methodname","args","rid","target","getAttribute","done","response","deleteRow","fail","reason"],"mappings":"mnCAwBAA,OAAM,oCAAC,CACH,WADG,CAAD,CAGH,SAAUC,CAAV,CAAgB,CACf,aAEA,GAAIC,CAAAA,CAAM,CAAG,UAAY,CAErB,GAAuC,IAAnC,EAAAC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAJ,CAA6C,CAEzC,KAAKC,kBAAL,EACH,CACJ,CAND,CAUAH,CAAM,CAACI,SAAP,CAAiBD,kBAAjB,CAAsC,UAAY,IACxCE,CAAAA,CAAI,CAAG,IADiC,CAExCC,CAAK,CAAGL,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAFgC,8BAG5BI,CAAK,CAACC,IAHsB,QAG9C,2BAA8B,IAAnBC,CAAAA,CAAmB,SACpBC,CAAC,CAAGD,CAAG,CAACE,KAAJ,CAAUC,MAAV,CAAmB,CADH,CAEpBC,CAAE,CAAIJ,CAAG,CAACE,KAAJ,CAAUD,CAAV,CAAD,CAAeI,QAAf,CAAwBF,MAAxB,CAAiC,CAFlB,CAGpBG,CAAQ,CAAGN,CAAG,CAACE,KAAJ,CAAUD,CAAV,EAAaI,QAAb,CAAsBD,CAAtB,CAHS,CAI1BG,OAAO,CAACC,GAAR,CAAYF,CAAZ,EACAA,CAAQ,CAACG,YAAT,CAAsB,gBAAtB,CAAwCT,CAAG,CAACU,QAA5C,EACAJ,CAAQ,CAACK,gBAAT,CAA0B,OAA1B,CAAmCd,CAAI,CAACe,cAAL,CAAoBC,IAApB,CAAyB,IAAzB,CAAnC,CACH,CAV6C,+BAWjD,CAXD,CAaArB,CAAM,CAACI,SAAP,CAAiBgB,cAAjB,CAAkC,SAAUE,CAAV,CAAa,CAE3C,GAAMjB,CAAAA,CAAI,CAAG,IAAb,CAEAA,CAAI,CAACa,QAAL,CAAgBI,CAAC,CAACC,UAAF,CAAaC,aAAb,CAA2BA,aAA3B,CAAyCA,aAAzC,CAAuDN,QAAvD,CAAkE,CAAlF,CAKAI,CAAC,CAACC,UAAF,CAAaC,aAAb,CAA2BC,SAA3B,CAAqCC,GAArC,CAAyC,UAAzC,EACAJ,CAAC,CAACC,UAAF,CAAaC,aAAb,CAA2BG,kBAA3B,CAA8CF,SAA9C,CAAwDG,MAAxD,CAA+D,UAA/D,EAEA7B,CAAI,CAAC8B,IAAL,CAAU,CAAC,CACPC,UAAU,CAAE,0CADL,CAEPC,IAAI,CAAE,CACFC,GAAG,CAAEV,CAAC,CAACW,MAAF,CAASC,YAAT,CAAsB,gBAAtB,CADH,CAFC,CAKPC,IAAI,CAAE,cAAUC,CAAV,CAAoB,CACtBrB,OAAO,CAACC,GAAR,CAAYoB,CAAZ,EAGAnC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,EAAgCmC,SAAhC,CAA0ChC,CAAI,CAACa,QAA/C,EAGA,GAAmD,CAA/C,EAAAjB,QAAQ,CAACC,aAAT,CAAuB,OAAvB,EAAgCK,IAAhC,CAAqCI,MAAzC,CAAsD,CAClDV,QAAQ,CAACC,aAAT,CAAuB,iBAAvB,EAA0CuB,SAA1C,CAAoDC,GAApD,CAAwD,UAAxD,CACH,CAEJ,CAhBM,CAiBPY,IAAI,CAAE,cAAUC,CAAV,CAAkB,CACpBxB,OAAO,CAACC,GAAR,CAAYuB,CAAZ,CACH,CAnBM,CAAD,CAAV,CAsBH,CAlCD,CAsCA,MAAOvC,CAAAA,CAEV,CArEK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n *\n *\n * @package    report\n * @subpackage reflectionexporter\n * @copyright  2022 Veronica Bermegui\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine([\n    'core/ajax',\n\n], function (Ajax) {\n    \"use strict\";\n\n    var Delete = function () {\n       \n        if (document.querySelector(\"tbody\") != null) {\n\n            this._addEventListeners();\n        }\n    }\n\n\n\n    Delete.prototype._addEventListeners = function () {\n        const self = this;\n        const table = document.querySelector(\"tbody\");\n        for (const row of table.rows) {\n            const l = row.cells.length - 1;\n            const cl = (row.cells[l]).children.length - 2;\n            const aElement = row.cells[l].children[cl];\n            console.log(aElement);\n            aElement.setAttribute('data-row-index', row.rowIndex);\n            aElement.addEventListener('click', self._deleteService.bind(this));\n        }\n    }\n\n    Delete.prototype._deleteService = function (e) {\n      \n        const self = this;\n       \n        self.rowIndex = e.srcElement.parentElement.parentElement.parentElement.rowIndex - 1;\n\n        // Call the service\n       \n        //Hide the bin and show the processing\n        e.srcElement.parentElement.classList.add('deleting');\n        e.srcElement.parentElement.nextElementSibling.classList.remove('deleting');\n      \n        Ajax.call([{\n            methodname: \"report_reflectionexporter_delete_process\",\n            args: {\n                rid: e.target.getAttribute('data-to-delete')\n            },\n            done: function (response) {\n                console.log(response);\n                // remove table row\n               \n                document.querySelector(\"tbody\").deleteRow(self.rowIndex);\n\n                // check if its the last row. if so, remove the table completely\n                if (document.querySelector(\"tbody\").rows.length == 0) {\n                    document.querySelector('div.select-work').classList.add('deleting');\n                }\n\n            },\n            fail: function (reason) {\n                console.log(reason);\n            }\n        }]);\n\n    }\n\n\n\n    return Delete;\n\n});"],"file":"delete.min.js"}