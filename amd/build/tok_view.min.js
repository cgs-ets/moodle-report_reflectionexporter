/**
 * Javascript to handle the PDF view
 *
 * @module     report_reflectionexporter/tok_view
 * @copyright  2023 Veronica Bermegui
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("report_reflectionexporter/tok_view",["core/templates","core/ajax"],(function(Templates,Ajax){var TokView=function(){var self=this;Templates.render("report_reflectionexporter/loading",{}).done((function(html,js){$('[data-region="pdf-comment-container"]').fadeOut("fast",function(){Templates.replaceNodeContents($('[data-region="pdf-comment-container"]'),html,js),$('[data-region="pdf-comment-container"]').fadeIn("fast")}.bind(this)),self._enableDownloadAndSummary()}))};return TokView.prototype._zipdownload=function(e){document.getElementById("zipform").submit()},TokView.prototype._enableDownloadAndSummary=function(){const self=this;document.getElementById("download").addEventListener("click",self._zipdownload);let notprocess=document.querySelector(".importing-animation").getAttribute("data-notprocess");notprocess=parseInt(notprocess,10),console.log("NOT PROCESS"),console.log(notprocess),notprocess>0&&(document.getElementById("summary").classList.remove("btn-summary-hidden"),document.getElementById("summary").addEventListener("click",self._loadsummary))},TokView.prototype._loadsummary=function(){Ajax.call([{methodname:"report_reflectionexporter_get_ommited",args:{recordid:document.querySelector('[data-region="viewer-navigation-panel"]').getAttribute("data-rid")},done:function(response){console.log(response);let context={students:JSON.parse(response.context)};console.log(context),Templates.render("report_reflectionexporter/students_table",context).done((function(html,js){Templates.replaceNodeContents(document.querySelector("div.omitted-table"),html,js);var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];modal.style.display="block",span.onclick=function(){modal.style.display="none"},window.onclick=function(event){event.target==modal&&(modal.style.display="none")}}))},fail:function(reason){console.log(reason)}}])},TokView}));

//# sourceMappingURL=tok_view.min.js.map