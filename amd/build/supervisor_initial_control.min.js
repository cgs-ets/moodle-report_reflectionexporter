/**
 * Provides the report_reflectionexporter/create_control module
 *
 * @package   report_reflectionexporter
 * @category  output
 * @copyright 2022 Veronica Bermegui
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("report_reflectionexporter/supervisor_initial_control",["jquery"],(function($){function SupervisorInitialControl(data){this.data=data}return SupervisorInitialControl.prototype.main=function(){this.initListeners()},SupervisorInitialControl.prototype.initListeners=function(){const self=this;if(null!=document.getElementById("id_coursegroups")){document.getElementById("id_coursegroups").addEventListener("change",function(e){$(e.target).find("option:selected").each((function(index,option){const groupid=option.value,teacher=document.querySelectorAll("[id^= id_teacher_".concat(groupid,"]"))[0];let teacherid="fitem_".concat(teacher.getAttribute("id"));const dEl=document.getElementById(teacherid);teacherid=teacherid.split("_"),teacherid=teacherid[teacherid.length-1],dEl.classList.remove("teacher-initial-field-hide");const details={groupid:groupid,teacherid:teacherid,delete:0};self.updateTeacherSelectionJSON(details)})),$("#id_coursegroups option:not(:selected)").each((function(index,option){const groupid=option.value,teacher=document.querySelectorAll("[id^= id_teacher_".concat(groupid,"]"))[0];let teacherid="fitem_".concat(teacher.getAttribute("id"));const dEl=document.getElementById(teacherid);teacherid=teacherid.split("_"),teacherid=teacherid[teacherid.length-1],dEl.classList.add("teacher-initial-field-hide");const details={groupid:groupid,teacherid:teacherid,delete:1};self.updateTeacherSelectionJSON(details)}))}.bind(self));const supervisorintials=document.querySelectorAll("[id^= id_teacher_]");$(supervisorintials).each((function(index,sinput){sinput.addEventListener("change",(function(e){let teacherid=e.target.getAttribute("id");teacherid=teacherid.split("_"),teacherid=teacherid[teacherid.length-1],console.log(e.target.value);const data={id:teacherid,si:e.target.value};self.updateTeacherInitial(data)}))})).bind(self)}},SupervisorInitialControl.prototype.updateTeacherSelectionJSON=function(details){let jsoninput=JSON.parse(document.getElementById("id_groupselectionjsonaux").value),jsoninputcurrent=JSON.parse(document.getElementById("id_groupselectionjson").value);1==details.delete?(jsoninputcurrent=jsoninputcurrent.filter((function(input){if(input.groupid!=details.groupid)return input}),details),document.getElementById("id_groupselectionjson").value=JSON.stringify(jsoninputcurrent)):(null==jsoninputcurrent.find((input=>input.groupid==details.groupid))&&(jsoninput=jsoninput.filter((function(input){if(input.groupid==details.groupid)return input}),details),jsoninputcurrent.push(jsoninput[0])),document.getElementById("id_groupselectionjson").value=JSON.stringify(jsoninputcurrent))},SupervisorInitialControl.prototype.updateTeacherInitial=function(data){console.log(data);let jsoninput=JSON.parse(document.getElementById("id_groupselectionjsonaux").value),jsoninputcurrent=JSON.parse(document.getElementById("id_groupselectionjson").value);jsoninputcurrent.forEach((function(teacher){teacher.id==data.id&&(teacher.si=data.si)}),data),jsoninput.forEach((function(teacher){teacher.id==data.id&&(teacher.si=data.si)}),data),document.getElementById("id_groupselectionjson").value=JSON.stringify(jsoninputcurrent),document.getElementById("id_groupselectionjsonaux").value=JSON.stringify(jsoninput)},{init:function(data){new SupervisorInitialControl(data).main()}}}));

//# sourceMappingURL=supervisor_initial_control.min.js.map